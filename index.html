<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ihsan - Fullstack Developer Portfolio</title>
    <style>
        /* Design System Variables */
        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-card: rgba(255, 255, 255, 0.03);
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0a0;
            --neon-purple: #6b2d9e;
            --neon-cyan: #1a7a8a;
            --neon-magenta: #8b3a62;
            --neon-glow: rgba(107, 45, 158, 0.5);
            --font-family-base: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            --font-family-mono: 'Courier New', monospace;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow-x: hidden;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: var(--font-family-base);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        #root {
            width: 100%;
            min-height: 100vh;
        }

        /* Game Container */
        .game-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: var(--bg-primary);
            overflow: hidden;
            z-index: 1000;
        }

        .game-canvas {
            width: 100%;
            height: 100%;
            display: block;
            background: var(--bg-primary);
        }

        .game-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .game-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 25px;
            border-radius: 12px;
            border: 1px solid var(--neon-purple);
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .game-controls p {
            margin: 5px 0;
            font-size: 14px;
            color: var(--text-primary);
        }

        .game-completion {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 50%, #0a0a0a 100%);
            padding: 40px;
            border-radius: 20px;
            border: 2px solid var(--neon-purple);
            box-shadow: 0 0 40px var(--neon-glow);
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        .game-completion h2 {
            font-size: 32px;
            color: var(--neon-purple);
            text-shadow: 0 0 20px var(--neon-glow);
            margin-bottom: 20px;
        }

        .skip-game-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid var(--neon-cyan);
            border-radius: 8px;
            color: var(--neon-cyan);
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            pointer-events: all;
            font-size: 14px;
            font-family: inherit;
        }

        .skip-game-btn:hover {
            background: var(--neon-cyan);
            color: var(--bg-primary);
            box-shadow: 0 0 20px var(--neon-cyan);
        }

        /* Navigation Bar */
        .navbar {
            position: sticky;
            top: 0;
            width: 100%;
            background: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-logo {
            font-size: 24px;
            font-weight: bold;
            color: var(--neon-purple);
            text-shadow: 0 0 10px var(--neon-glow);
        }

        .nav-links {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-links a {
            color: var(--text-primary);
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
            padding: 5px 0;
            cursor: pointer;
        }

        .nav-links a:hover {
            color: var(--neon-purple);
        }

        .nav-links a.active {
            color: var(--neon-purple);
        }

        .nav-links a.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--neon-purple);
            box-shadow: 0 0 10px var(--neon-glow);
        }

        /* Main Container */
        .main-container {
            min-height: calc(100vh - 60px);
            animation: fadeIn 0.5s ease;
        }

        .page {
            max-width: 1280px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Profile Section */
        .profile-section {
            text-align: center;
            padding: 60px 20px 40px;
            animation: slideUp 0.6s ease;
        }

        .profile-image {
            width: 180px;
            height: 220px;
            border-radius: 50%;
            border: 4px solid var(--neon-purple);
            box-shadow: 0 0 30px var(--neon-glow);
            margin: 0 auto 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 50%, #0a0a0a 100%);
            font-size: 64px;
        }

        .profile-name {
            font-size: 48px;
            font-weight: bold;
            color: var(--neon-purple);
            text-shadow: 0 0 20px var(--neon-glow);
            margin-bottom: 10px;
        }

        .profile-title {
            font-size: 24px;
            color: var(--neon-cyan);
            margin-bottom: 20px;
        }

        .profile-bio {
            font-size: 16px;
            color: var(--text-secondary);
            max-width: 800px;
            margin: 0 auto 40px;
            line-height: 1.8;
        }

        /* Social Links */
        .social-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            max-width: 900px;
            margin: 0 auto 50px;
        }

        .social-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .social-card:hover {
            transform: scale(1.1);
            border-color: var(--neon-purple);
            box-shadow: 0 0 30px var(--neon-glow);
        }

        .social-card a {
            text-decoration: none;
            color: var(--text-primary);
            display: block;
        }

        .social-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .social-name {
            font-size: 18px;
            font-weight: 500;
        }

        /* Music Player */
        .music-player-container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 30px;
            animation: slideUp 0.8s ease;
        }

        .music-player-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .music-player-header h3 {
            color: var(--neon-purple);
            font-size: 24px;
            margin-bottom: 10px;
        }

        .track-title {
            font-size: 18px;
            color: var(--text-primary);
            margin-bottom: 20px;
            text-align: center;
            font-weight: 500;
        }

        .audio-player {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
        }

        .player-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .control-btn {
            background: var(--neon-purple);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .control-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 0 20px var(--neon-glow);
        }

        .control-btn.play-btn {
            width: 50px;
            height: 50px;
            font-size: 20px;
        }

        .progress-container {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            cursor: pointer;
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: var(--neon-purple);
            border-radius: 3px;
            transition: width 0.1s linear;
            box-shadow: 0 0 10px var(--neon-glow);
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .volume-slider {
            flex: 1;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            cursor: pointer;
            position: relative;
        }

        .volume-bar {
            height: 100%;
            background: var(--neon-cyan);
            border-radius: 3px;
            box-shadow: 0 0 10px var(--neon-cyan);
        }

        /* Projects Grid */
        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            padding: 20px 0;
        }

        .project-card {
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 50%, #0a0a0a 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 30px;
            transition: all 0.3s ease;
            animation: slideUp 0.6s ease;
        }

        .project-card:hover {
            transform: translateY(-10px) scale(1.02);
            border-color: var(--neon-purple);
            box-shadow: 0 0 30px var(--neon-glow);
        }

        .project-card h3 {
            font-size: 24px;
            color: var(--neon-purple);
            text-shadow: 0 0 10px var(--neon-glow);
            margin-bottom: 15px;
        }

        .project-card p {
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .tech-stack {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tech-badge {
            background: rgba(107, 45, 158, 0.2);
            border: 1px solid var(--neon-purple);
            color: var(--neon-purple);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .features-list {
            list-style: none;
            margin-bottom: 20px;
        }

        .features-list li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            color: var(--text-primary);
            font-size: 14px;
        }

        .features-list li::before {
            content: '‚ñπ';
            position: absolute;
            left: 0;
            color: var(--neon-cyan);
            font-weight: bold;
        }

        .highlight-box {
            background: rgba(26, 122, 138, 0.1);
            border-left: 3px solid var(--neon-cyan);
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .highlight-box strong {
            color: var(--neon-cyan);
            display: block;
            margin-bottom: 8px;
        }

        /* Chatroom */
        .chatroom-container {
            max-width: 800px;
            margin: 0 auto;
            height: calc(100vh - 200px);
            display: flex;
            flex-direction: column;
        }

        .join-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            gap: 20px;
        }

        .join-screen h2 {
            color: var(--neon-purple);
            font-size: 32px;
            text-shadow: 0 0 20px var(--neon-glow);
        }

        .join-screen input {
            width: 100%;
            max-width: 400px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 16px;
            font-family: inherit;
        }

        .join-screen input:focus {
            outline: none;
            border-color: var(--neon-purple);
            box-shadow: 0 0 20px var(--neon-glow);
        }

        .join-btn, .send-btn {
            padding: 15px 40px;
            background: var(--neon-purple);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .join-btn:hover, .send-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px var(--neon-glow);
        }

        .chat-header {
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 50%, #0a0a0a 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px 12px 0 0;
            padding: 20px;
            text-align: center;
        }

        .chat-header h3 {
            color: var(--neon-purple);
            font-size: 24px;
        }

        .online-count {
            color: var(--neon-cyan);
            font-size: 14px;
            margin-top: 5px;
        }

        .messages-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.02);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .messages-container::-webkit-scrollbar {
            width: 8px;
        }

        .messages-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .messages-container::-webkit-scrollbar-thumb {
            background: var(--neon-purple);
            border-radius: 4px;
        }

        .message {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 15px;
            animation: messageSlide 0.3s ease;
        }

        .message.own-message {
            background: rgba(107, 45, 158, 0.1);
            border-color: var(--neon-purple);
            margin-left: auto;
            max-width: 80%;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .message-username {
            font-weight: 600;
            color: var(--neon-cyan);
        }

        .message-timestamp {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .message-text {
            color: var(--text-primary);
            word-wrap: break-word;
        }

        .input-container {
            display: flex;
            gap: 10px;
            padding: 20px;
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 50%, #0a0a0a 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0 0 12px 12px;
        }

        .input-container input {
            flex: 1;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
        }

        .input-container input:focus {
            outline: none;
            border-color: var(--neon-purple);
        }

        /* Passion Sections */
        .passion-card {
            background: linear-gradient(135deg, #2a2a2a 0%, #1a1a1a 50%, #0a0a0a 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
            margin-bottom: 40px;
            animation: slideUp 0.6s ease;
        }

        .banner-area {
            width: 100%;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            font-weight: bold;
            color: white;
            text-shadow: 0 0 20px rgba(0,0,0,0.5);
        }

        .banner-football {
            background: linear-gradient(135deg, #1a7a8a 0%, #6b2d9e 100%);
        }

        .banner-cars {
            background: linear-gradient(90deg, #ff4500 0%, #8b3a62 100%);
        }

        .banner-hacking {
            background: #000;
            color: #0f0;
            font-family: var(--font-family-mono);
        }

        .passion-content {
            padding: 40px;
        }

        .passion-content h2 {
            font-size: 36px;
            color: var(--neon-purple);
            text-shadow: 0 0 20px var(--neon-glow);
            margin-bottom: 20px;
        }

        .passion-content h3 {
            font-size: 24px;
            color: var(--neon-cyan);
            margin: 30px 0 15px;
        }

        .philosophy-text, .intro-text {
            font-size: 18px;
            line-height: 1.8;
            color: var(--text-primary);
            margin-bottom: 30px;
        }

        .philosophy-grid, .ethos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .philosophy-point, .ethos-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 25px;
            transition: all 0.3s ease;
        }

        .philosophy-point:hover, .ethos-card:hover {
            transform: translateY(-5px);
            border-color: var(--neon-purple);
            box-shadow: 0 0 20px var(--neon-glow);
        }

        .philosophy-point h4, .ethos-card h4 {
            font-size: 18px;
            color: var(--neon-purple);
            margin-bottom: 12px;
        }

        .ethos-card .icon {
            font-size: 32px;
            margin-bottom: 15px;
        }

        .quote-box {
            background: rgba(26, 122, 138, 0.1);
            border-left: 4px solid var(--neon-cyan);
            padding: 25px;
            border-radius: 8px;
            font-style: italic;
            font-size: 18px;
            line-height: 1.8;
            color: var(--text-primary);
            margin: 30px 0;
        }

        .stats-display {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .stat-label {
            display: block;
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .stat-value {
            display: block;
            font-size: 18px;
            font-weight: 600;
            color: var(--neon-purple);
        }

        .dream-garage ul, .focus-list {
            list-style: none;
            padding: 0;
        }

        .dream-garage li, .focus-list li {
            padding: 12px 0;
            padding-left: 30px;
            position: relative;
            color: var(--text-primary);
            font-size: 16px;
        }

        .dream-garage li::before {
            content: 'üèéÔ∏è';
            position: absolute;
            left: 0;
        }

        .focus-list li::before {
            content: '‚ñπ';
            position: absolute;
            left: 0;
            color: var(--neon-cyan);
        }

        /* Terminal Styles */
        .terminal-font {
            font-family: var(--font-family-mono);
        }

        .terminal-window {
            background: #000;
            border: 1px solid var(--neon-purple);
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
            box-shadow: 0 0 30px var(--neon-glow);
        }

        .terminal-header {
            color: var(--neon-cyan);
            font-family: var(--font-family-mono);
            margin-bottom: 15px;
        }

        .terminal-content p {
            font-family: var(--font-family-mono);
            color: #0f0;
            margin: 8px 0;
            font-size: 14px;
        }

        .success-text {
            color: #0f0 !important;
            font-weight: bold;
        }

        .skills-terminal {
            margin: 30px 0;
        }

        .terminal-output {
            background: #000;
            border: 1px solid var(--neon-purple);
            border-radius: 8px;
            padding: 20px;
        }

        .skill-line {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 12px 0;
            font-family: var(--font-family-mono);
        }

        .prompt {
            color: var(--neon-cyan);
        }

        .skill {
            flex: 1;
            color: var(--text-primary);
        }

        .level {
            color: var(--neon-purple);
            font-size: 12px;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes messageSlide {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .hidden {
            display: none;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .profile-name { font-size: 36px; }
            .profile-title { font-size: 20px; }
            .social-links { grid-template-columns: repeat(2, 1fr); }
            .projects-grid { grid-template-columns: 1fr; }
            .passion-content { padding: 25px; }
            .passion-content h2 { font-size: 28px; }
            .philosophy-grid, .ethos-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        // Global state
        const state = {
            currentPage: 'game',
            gameCompleted: false,
            username: '',
            hasJoined: false,
            messages: [
                { username: 'System', message: 'Welcome to the global chatroom!', timestamp: new Date().toISOString() },
                { username: 'Alex', message: 'Hey everyone! üëã', timestamp: new Date(Date.now() - 300000).toISOString() },
                { username: 'Sarah', message: 'Nice portfolio Ihsan!', timestamp: new Date(Date.now() - 240000).toISOString() },
                { username: 'Dev123', message: 'The game is awesome!', timestamp: new Date(Date.now() - 180000).toISOString() },
                { username: 'Mike', message: 'Love the design aesthetic', timestamp: new Date(Date.now() - 120000).toISOString() },
                { username: 'Emma', message: 'How did you build this?', timestamp: new Date(Date.now() - 60000).toISOString() }
            ],
            chatInput: '',
            currentTrack: 0,
            isPlaying: false,
            volume: 0.7
        };

        const playlist = [
            { title: "Tokyo Drift Various", duration: 225, file: 'assets/Tokyo-Drift-Various.mp3' },
            { title: "Govinda - A Modern Mantra", duration: 255, file: 'assets/Govinda_-_A_Modern_Mantra_-mp3.pm.mp3' },
            { title: "Kadi Te Has Bol Ve", duration: 210, file: 'assets/Kadi_Te_Has_Bol_Ve.mp3' }
        ];

        // Render functions
        function render() {
            const root = document.getElementById('root');
            
            if (state.currentPage === 'game') {
                root.innerHTML = renderGamePage();
                initGame();
            } else {
                root.innerHTML = `
                    ${renderNavbar()}
                    <div class="main-container">
                ${state.currentPage === 'dashboard' ? renderDashboard() : ''}
                    ${state.currentPage === 'projects' ? renderProjects() : ''}
                    ${state.currentPage === 'passion' ? renderPassion() : ''}
                    </div>
                `;
                
                if (state.currentPage === 'dashboard') {
                    initMusicPlayer();
                }
            }
            
            attachEventListeners();
        }

        function renderNavbar() {
            return `
                <nav class="navbar">
                    <div class="nav-container">
                        <div class="nav-logo">IHSAN.ME</div>
                        <ul class="nav-links">
                            <li><a class="${state.currentPage === 'dashboard' ? 'active' : ''}" data-page="dashboard">Dashboard</a></li>
                            <li><a class="${state.currentPage === 'projects' ? 'active' : ''}" data-page="projects">Projects</a></li>
                            <li><a class="${state.currentPage === 'passion' ? 'active' : ''}" data-page="passion">My Passion</a></li>
                        </ul>
                    </div>
                </nav>
            `;
        }

        function renderGamePage() {
            return `
                <div class="game-container">
                    <canvas id="gameCanvas" class="game-canvas"></canvas>
                    <div class="game-overlay">
                        <button class="skip-game-btn" id="skipGameBtn">Skip Game</button>
                        <div class="game-controls" id="gameControls">
                            <p><strong>Controls:</strong></p>
                            <p>Arrow Keys or WASD: Move Left/Right</p>
                            <p>SPACE: Jump</p>
                            <p>Reach the glowing platform to continue!</p>
                        </div>
                        <div class="game-completion hidden" id="gameCompletion">
                            <h2>üéÆ PORTFOLIO UNLOCKED!</h2>
                            <p>Loading Dashboard...</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderDashboard() {
            return `
                <div class="page dashboard-page">
                    <div class="profile-section"> <img
                            src="assets/IMG_0362.jpg"
                            alt="Ihsan"
                            class="profile-image"
                            onerror="this.onerror=null; this.src='IMG_0362.jpg';"
                        />
                        <h1 class="profile-name">Ihsan</h1>
                        <h2 class="profile-title">Fullstack Developer</h2>
                        <p class="profile-bio">
                            Node.js (Express, NestJS) | React.js | Next.js | PostgreSQL | GraphQL | REST APIs | WebSockets | Firebase | Supabase | Server Deployment &amp; Hosting
                        </p>

                        <div class="social-links">
                            <div class="social-card">
                                <a href="https://linkedin.com/in/ikihsan" target="_blank" rel="noopener noreferrer">
                                    <div class="social-icon">üíº</div>
                                    <p class="social-name">LinkedIn</p>
                                </a>
                            </div>
                            <div class="social-card">
                                <a href="https://github.com/ikihsan" target="_blank" rel="noopener noreferrer">
                                    <div class="social-icon">üíª</div>
                                    <p class="social-name">GitHub</p>
                                </a>
                            </div>
                            <div class="social-card">
                                <a href="https://wa.me/9037312356" target="_blank" rel="noopener noreferrer">
                                    <div class="social-icon">üí¨</div>
                                    <p class="social-name">WhatsApp</p>
                                </a>
                            </div>
                            <div class="social-card">
                                <a href="mailto:ikihsaan@gmail.com">
                                    <div class="social-icon">‚úâÔ∏è</div>
                                    <p class="social-name">Email</p>
                                </a>
                            </div>
                        </div>

                        ${renderMusicPlayer()}
                    </div>
                </div>
            `;
        }

        function renderMusicPlayer() {
            return `
                <div class="music-player-container">
                    <div class="music-player-header">
                        <h3>üéµ Now Playing</h3>
                    </div>
                        <p class="track-title" id="trackTitle">${playlist[state.currentTrack].title}</p>
                    <audio id="audioEl" preload="metadata"></audio>
                    <div class="audio-player">
                        <div class="player-controls">
                            <button class="control-btn" id="prevBtn">‚èÆ</button>
                            <button class="control-btn play-btn" id="playBtn">${state.isPlaying ? '‚è∏' : '‚ñ∂'}</button>
                            <button class="control-btn" id="nextBtn">‚è≠</button>
                            <div class="progress-container" id="progressContainer">
                                <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                            </div>
                        </div>
                        <div class="time-display">
                            <span id="currentTime">0:00</span>
                            <span id="duration">${formatTime(playlist[state.currentTrack].duration)}</span>
                        </div>
                        <div class="volume-control">
                            <span>üîä</span>
                            <div class="volume-slider" id="volumeSlider">
                                <div class="volume-bar" id="volumeBar" style="width: ${state.volume * 100}%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderProjects() {
            const projects = [
                {
                    title: "AI Mock Interview Platform",
                    description: "Intelligent interview preparation system with real-time feedback",
                    tech: ["Express.js", "Gemini AI", "React.js", "MongoDB"],
                    features: [
                        "AI-powered question generation based on job role",
                        "Real-time speech recognition and analysis",
                        "Performance scoring with detailed feedback",
                        "Mock interview session recording and playback"
                    ],
                    highlight: "Leverages Google's Gemini AI for natural conversation flow"
                },
                {
                    title: "Vehicle Auction &amp; Bidding Platform",
                    description: "Real-time bidding system for vehicle auctions",
                    tech: ["NestJS", "Node.js", "Next.js", "PostgreSQL", "Prisma ORM", "Firebase"],
                    features: [
                        "Live bidding with WebSocket real-time updates",
                        "Automated auction scheduling and notifications",
                        "Image upload and management via Firebase Storage",
                        "User authentication and role-based access",
                        "Transaction history and invoice generation"
                    ],
                    highlight: "Handles concurrent bidding with optimistic locking"
                },
                {
                    title: "SaaS Company Management System",
                    description: "Enterprise-grade management platform with full deployment",
                    tech: ["Next.js", "NestJS", "Supabase", "Ubuntu Server", "Monitoring Tools"],
                    features: [
                        "Multi-tenant architecture with role hierarchies",
                        "Real-time dashboard with analytics",
                        "Automated deployment pipeline",
                        "Server monitoring and health checks",
                        "API rate limiting and security layers"
                    ],
                    highlight: "Production-ready with CI/CD and server monitoring"
                },
                {
                    title: "User Vlogging System",
                    description: "Video content management platform for creators",
                    tech: ["NestJS", "Node.js", "Next.js", "PostgreSQL", "Prisma ORM"],
                    features: [
                        "Video upload with compression and transcoding",
                        "Social features: likes, comments, subscriptions",
                        "Content recommendation algorithm",
                        "Creator analytics dashboard",
                        "Search and filtering system"
                    ],
                    highlight: "Optimized video delivery with CDN integration"
                }
            ];

            return `
                <div class="page projects-page">
                    <h1 style="text-align: center; font-size: 42px; color: var(--neon-purple); text-shadow: 0 0 20px var(--neon-glow); margin-bottom: 40px;">My Projects</h1>
                    <div class="projects-grid">
                        ${projects.map(project => `
                            <div class="project-card">
                                <h3>${project.title}</h3>
                                <p>${project.description}</p>
                                <div class="tech-stack">
                                    ${project.tech.map(tech => `<span class="tech-badge">${tech}</span>`).join('')}
                                </div>
                                <ul class="features-list">
                                    ${project.features.map(feature => `<li>${feature}</li>`).join('')}
                                </ul>
                                <div class="highlight-box">
                                    <strong>Key Innovation:</strong> ${project.highlight}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // Chatroom removed

        function renderPassion() {
            return `
                <div class="page passion-page">
                    <h1 style="text-align: center; font-size: 42px; color: var(--neon-purple); text-shadow: 0 0 20px var(--neon-glow); margin-bottom: 40px;">My Passions</h1>
                    
                    <div class="passion-card">
                        <div class="banner-area banner-football">MIDFIELD MAESTRO</div>
                        <div class="passion-content">
                            <h2>The Architect, Not The Finisher</h2>
                            <p class="philosophy-text">
                                In football, I find my truest self in the midfield - not hunting glory in the spotlight, but orchestrating it from the shadows. While strikers chase headlines with goals, I chase perfection in the through-ball that splits the defense.
                            </p>
                            <div class="highlight-box">
                                <h3>My Playing Philosophy</h3>
                                <ul class="features-list">
                                    <li><strong>Vision Over Vanity:</strong> I see passes others do not, creating chances for glory</li>
                                    <li><strong>Control the Tempo:</strong> The heartbeat of the team flows through my positioning</li>
                                    <li><strong>Sacrifice for Success:</strong> Running miles to win the ball back</li>
                                    <li><strong>The Real Skill Wears a Mask:</strong> Let them celebrate the goal - I know who created it</li>
                                </ul>
                            </div>
                            <div class="quote-box">
                                I want to be the one who creates heroes. The true skill lies in making others shine while mastering the art that no one sees.
                            </div>
                            <div class="stats-display">
                                <div class="stat">
                                    <span class="stat-label">Favorite Position</span>
                                    <span class="stat-value">Central/Attacking Midfielder</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Play Style</span>
                                    <span class="stat-value">Playmaker</span>
                                </div>
                                <div class="stat">
                                    <span class="stat-label">Inspiration</span>
                                    <span class="stat-value">Luka Modriƒá, De Bruyne</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="passion-card">
                        <div class="banner-area banner-cars">TOKYO DRIFT</div>
                        <div class="passion-content">
                            <h2>Rear-Wheel Drive Philosophy</h2>
                            <p class="intro-text">
                                There is something raw and honest about rear-wheel drive. No electronic nannies holding your hand. Just you, the throttle, and the physics of controlled chaos. Drifting is about mastering the edge where control meets surrender.
                            </p>
                            <h3>Why Drifting Resonates</h3>
                            <div class="philosophy-grid">
                                <div class="philosophy-point">
                                    <h4>üèéÔ∏è The Purist Choice</h4>
                                    <p>Rear-wheel drive demands skill. Every input matters. No hiding behind technology.</p>
                                </div>
                                <div class="philosophy-point">
                                    <h4>üî• Controlled Chaos</h4>
                                    <p>The beauty of a perfect drift: the car dancing on the edge of grip, yet under control.</p>
                                </div>
                                <div class="philosophy-point">
                                    <h4>üåü Tokyo Spirit</h4>
                                    <p>Inspired by the Tokyo drift scene - where mountain passes become canvases.</p>
                                </div>
                                <div class="philosophy-point">
                                    <h4>‚öôÔ∏è The Connection</h4>
                                    <p>The connection between man and machine. Feeling every weight transfer.</p>
                                </div>
                            </div>
                            <div class="quote-box">
                                In drifting, perfection is about dancing with chaos and making it look intentional. Every drift is a conversation between rubber and asphalt.
                            </div>
                            <div class="dream-garage">
                                <h3>Dream Machines</h3>
                                <ul>
                                    <li><strong>Mazda RX-7 FD:</strong> Rotary soul, perfect balance</li>
                                    <li><strong>Nissan Silvia S15:</strong> The drift king weapon</li>
                                    <li><strong>Toyota AE86:</strong> Where the legend began</li>
                                    <li><strong>BMW E46 M3:</strong> European precision with sideways attitude</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="passion-card">
                        <div class="banner-area banner-hacking">$ sudo su</div>
                        <div class="passion-content">
                            <h2 class="terminal-font">$ sudo su -</h2>
                            <h3>Living in the Terminal</h3>
                            <div class="terminal-window">
                                <div class="terminal-header">ihsan@localhost:~$</div>
                                <div class="terminal-content">
                                    <p>&gt; Initializing mindset...</p>
                                    <p>&gt; Loading curiosity.dll</p>
                                    <p>&gt; Mounting /dev/persistence</p>
                                    <p class="success-text">&gt; System compromised. Access granted.</p>
                                </div>
                            </div>
                            <p class="philosophy-text">
                                There is a unique thrill in understanding systems at their core. Hacking is about seeing beyond the interface, understanding the logic that powers digital life.
                            </p>
                            <h3>The Hacker Mindset</h3>
                            <div class="ethos-grid">
                                <div class="ethos-card">
                                    <div class="icon">üîç</div>
                                    <h4>Insatiable Curiosity</h4>
                                    <p>Every system is a puzzle. I dissect technology and make it bend to my will.</p>
                                </div>
                                <div class="ethos-card">
                                    <div class="icon">üõ°Ô∏è</div>
                                    <h4>Security Obsession</h4>
                                    <p>I study vulnerabilities to fortify. The best defense is understanding offense.</p>
                                </div>
                                <div class="ethos-card">
                                    <div class="icon">‚ö°</div>
                                    <h4>Terminal Mastery</h4>
                                    <p>The terminal is home. Bash scripts, Python automation - this is where power lives.</p>
                                </div>
                                <div class="ethos-card">
                                    <div class="icon">üéØ</div>
                                    <h4>Problem Solver</h4>
                                    <p>Every bug is a challenge. I hunt errors and emerge with solutions.</p>
                                </div>
                            </div>
                            <div class="skills-terminal">
                                <h3>$ cat skills.txt</h3>
                                <div class="terminal-output">
                                    <div class="skill-line">
                                        <span class="prompt">&gt;</span>
                                        <span class="skill">Network Penetration Testing</span>
                                        <span class="level">[‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë] 80%</span>
                                    </div>
                                    <div class="skill-line">
                                        <span class="prompt">&gt;</span>
                                        <span class="skill">Linux System Administration</span>
                                        <span class="level">[‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë] 90%</span>
                                    </div>
                                    <div class="skill-line">
                                        <span class="prompt">&gt;</span>
                                        <span class="skill">Python Automation &amp; Scripting</span>
                                        <span class="level">[‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë] 85%</span>
                                    </div>
                                    <div class="skill-line">
                                        <span class="prompt">&gt;</span>
                                        <span class="skill">Cybersecurity Fundamentals</span>
                                        <span class="level">[‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë] 75%</span>
                                    </div>
                                    <div class="skill-line">
                                        <span class="prompt">&gt;</span>
                                        <span class="skill">Reverse Engineering</span>
                                        <span class="level">[‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë] 60%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="quote-box">
                                They see black screen and panic. I see black screen and feel at home. In the terminal, I am a conductor orchestrating digital symphonies.
                            </div>
                            <div class="learning-path">
                                <h3>Current Focus Areas</h3>
                                <ul class="focus-list">
                                    <li>OWASP Top 10 vulnerabilities and mitigation</li>
                                    <li>Container security and Docker hardening</li>
                                    <li>Web application penetration testing</li>
                                    <li>Wireless network security and packet analysis</li>
                                    <li>Ethical hacking certifications (CEH, OSCP track)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Game initialization
        function initGame() {
            const canvas = document.getElementById('gameCanvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            // Game objects
            const player = {
                x: 100,
                y: 300,
                width: 30,
                height: 40,
                velocityX: 0,
                velocityY: 0,
                speed: 5,
                jumpPower: 15,
                onGround: false
            };

            const platforms = [
                { x: 50, y: 450, width: 200, height: 20 },
                { x: 300, y: 380, width: 150, height: 20 },
                { x: 500, y: 300, width: 150, height: 20 },
                { x: 700, y: 220, width: 150, height: 20 },
                { x: 900, y: 150, width: 200, height: 20 }
            ];

            const finishPlatform = { x: 900, y: 150, width: 200, height: 20 };
            const gravity = 0.8;
            const keys = {};
            let gameCompleted = false;

            // Event listeners
            window.addEventListener('keydown', (e) => {
                keys[e.code] = true;
                if (e.code === 'Space') e.preventDefault();
            });

            window.addEventListener('keyup', (e) => {
                keys[e.code] = false;
            });

            window.addEventListener('resize', () => {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            });

            function update() {
                if (gameCompleted) return;

                // Movement
                player.velocityX = 0;
                if (keys['ArrowLeft'] || keys['KeyA']) {
                    player.velocityX = -player.speed;
                }
                if (keys['ArrowRight'] || keys['KeyD']) {
                    player.velocityX = player.speed;
                }

                // Jumping
                if ((keys['Space'] || keys['ArrowUp'] || keys['KeyW']) && player.onGround) {
                    player.velocityY = -player.jumpPower;
                    player.onGround = false;
                }

                // Apply gravity
                player.velocityY += gravity;

                // Update position
                player.x += player.velocityX;
                player.y += player.velocityY;

                // Check platform collisions
                player.onGround = false;
                platforms.forEach(platform => {
                    if (player.x + player.width > platform.x &&
                        player.x < platform.x + platform.width &&
                        player.y + player.height >= platform.y &&
                        player.y + player.height <= platform.y + platform.height &&
                        player.velocityY >= 0) {
                        player.y = platform.y - player.height;
                        player.velocityY = 0;
                        player.onGround = true;
                    }
                });

                // Check finish condition
                if (player.x + player.width > finishPlatform.x + 50 &&
                    player.x < finishPlatform.x + finishPlatform.width - 50 &&
                    player.y + player.height >= finishPlatform.y &&
                    player.y <= finishPlatform.y + finishPlatform.height) {
                    gameCompleted = true;
                    document.getElementById('gameControls').classList.add('hidden');
                    document.getElementById('gameCompletion').classList.remove('hidden');
                    setTimeout(() => {
                        state.currentPage = 'dashboard';
                        state.gameCompleted = true;
                        render();
                    }, 2000);
                }

                // Keep player in bounds
                if (player.y > canvas.height) {
                    player.y = 100;
                    player.x = 100;
                    player.velocityY = 0;
                }
            }

            function draw() {
                // Clear canvas
                ctx.fillStyle = '#0a0a0a';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Draw platforms
                platforms.forEach((platform, index) => {
                    if (index === platforms.length - 1) {
                        // Finish platform - glowing
                        ctx.shadowBlur = 20;
                        ctx.shadowColor = '#1a7a8a';
                        ctx.fillStyle = '#1a7a8a';
                    } else {
                        ctx.shadowBlur = 0;
                        ctx.fillStyle = '#2a2a2a';
                    }
                    ctx.fillRect(platform.x, platform.y, platform.width, platform.height);
                    
                    // Platform border
                    ctx.strokeStyle = '#6b2d9e';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(platform.x, platform.y, platform.width, platform.height);
                });

                // Draw player
                ctx.shadowBlur = 15;
                ctx.shadowColor = '#6b2d9e';
                ctx.fillStyle = '#6b2d9e';
                ctx.fillRect(player.x, player.y, player.width, player.height);
                
                // Player eyes
                ctx.fillStyle = '#ffffff';
                ctx.fillRect(player.x + 8, player.y + 10, 5, 5);
                ctx.fillRect(player.x + 17, player.y + 10, 5, 5);
                
                ctx.shadowBlur = 0;
            }

            function gameLoop() {
                update();
                draw();
                requestAnimationFrame(gameLoop);
            }

            gameLoop();
        }

        // Music player initialization
        let musicInterval = null;
        let currentTime = 0;

        function initMusicPlayer() {
            const audio = document.getElementById('audioEl');
            if (!audio) return;

            // load current track
            audio._fallbackTried = false;
            audio.src = playlist[state.currentTrack].file || '';
            audio.volume = state.volume ?? 0.7;

            const updateProgress = () => {
                const progressBar = document.getElementById('progressBar');
                const currentTimeEl = document.getElementById('currentTime');
                const durationEl = document.getElementById('duration');
                const dur = audio.duration || playlist[state.currentTrack].duration || 0;
                if (progressBar && dur > 0) {
                    const pct = (audio.currentTime / dur) * 100;
                    progressBar.style.width = pct + '%';
                }
                if (currentTimeEl) currentTimeEl.textContent = formatTime(Math.floor(audio.currentTime));
                if (durationEl) durationEl.textContent = formatTime(Math.floor(dur));
            };

            const onEnded = () => {
                audio.currentTime = 0;
                state.currentTrack = (state.currentTrack + 1) % playlist.length;
                state.isPlaying = true;
                render();
            };

            const handleError = () => {
                // Try root filename fallback once when assets path fails
                const tried = audio._fallbackTried || false;
                const src = audio.src || '';
                console.warn('Audio load error for', src);
                if (!tried) {
                    audio._fallbackTried = true;
                    const fallback = (playlist[state.currentTrack].file || '').replace(/^assets\//, '');
                    if (fallback && fallback !== audio.src) {
                        console.warn('Attempting fallback audio src:', fallback);
                        try {
                            audio.src = fallback;
                            audio.load();
                            if (state.isPlaying) audio.play().catch(err => { console.warn('Fallback play prevented:', err); state.isPlaying = false; render(); });
                        } catch (e) {
                            console.warn('Fallback audio load failed', e);
                        }
                        return;
                    }
                }
                // If fallback didn't work, stop playing and show console message
                state.isPlaying = false;
                render();
            };

            audio.removeEventListener('timeupdate', updateProgress);
            audio.removeEventListener('ended', onEnded);
            audio.removeEventListener('error', handleError);
            audio.addEventListener('timeupdate', updateProgress);
            audio.addEventListener('ended', onEnded);
            audio.addEventListener('error', handleError);

            if (state.isPlaying) {
                audio.play().catch(err => {
                    console.warn('Audio play prevented:', err);
                    state.isPlaying = false;
                    render();
                });
            }
        }

        function startMusicSimulation() {
            // play via audio element
            const audio = document.getElementById('audioEl');
            if (!audio) return;
            audio._fallbackTried = false;
            audio.src = playlist[state.currentTrack].file || '';
            audio.currentTime = currentTime || 0;
            audio.volume = state.volume ?? 0.7;
            audio.play().catch(err => {
                console.warn('Audio play prevented:', err);
                state.isPlaying = false;
                render();
            });
        }

        function stopMusicSimulation() {
            const audio = document.getElementById('audioEl');
            if (!audio) return;
            audio.pause();
            currentTime = audio.currentTime || 0;
        }

        // Chatroom removed

        // Event listeners
        function attachEventListeners() {
            // Navigation
            document.querySelectorAll('[data-page]').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    state.currentPage = e.target.dataset.page;
                    render();
                });
            });

            // Skip game
            const skipBtn = document.getElementById('skipGameBtn');
            if (skipBtn) {
                skipBtn.addEventListener('click', () => {
                    state.currentPage = 'dashboard';
                    render();
                });
            }

            // Music player
            const playBtn = document.getElementById('playBtn');
            if (playBtn) {
                playBtn.addEventListener('click', async () => {
                    const audio = document.getElementById('audioEl');
                    if (!audio) {
                        console.warn('Play clicked but audio element not found');
                        return;
                    }

                    if (state.isPlaying) {
                        // Pause without re-rendering
                        audio.pause();
                        state.isPlaying = false;
                        currentTime = audio.currentTime || 0;
                        playBtn.textContent = '‚ñ∂';
                        const currentTimeEl = document.getElementById('currentTime');
                        if (currentTimeEl) currentTimeEl.textContent = formatTime(Math.floor(currentTime));
                    } else {
                        // Attempt to play (user gesture) and update UI directly
                        audio._fallbackTried = false;
                        audio.src = playlist[state.currentTrack].file || '';
                        audio.volume = state.volume ?? 0.7;
                        try {
                            await audio.play();
                            state.isPlaying = true;
                            playBtn.textContent = '‚è∏';
                        } catch (err) {
                            console.warn('Play prevented or failed:', err);
                            state.isPlaying = false;
                            playBtn.textContent = '‚ñ∂';
                        }
                    }
                });
            }

            const prevBtn = document.getElementById('prevBtn');
            if (prevBtn) {
                prevBtn.addEventListener('click', async () => {
                    state.currentTrack = (state.currentTrack - 1 + playlist.length) % playlist.length;
                    currentTime = 0;
                    const audio = document.getElementById('audioEl');
                    const trackTitle = document.getElementById('trackTitle');
                    if (trackTitle) trackTitle.textContent = playlist[state.currentTrack].title;
                    if (audio) {
                        audio._fallbackTried = false;
                        audio.src = playlist[state.currentTrack].file || '';
                        audio.currentTime = 0;
                        audio.volume = state.volume ?? 0.7;
                        if (state.isPlaying) {
                            try { await audio.play(); } catch (err) { console.warn('Play on prev failed:', err); state.isPlaying = false; const p = document.getElementById('playBtn'); if (p) p.textContent = '‚ñ∂'; }
                        }
                    }
                });
            }

            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn) {
                nextBtn.addEventListener('click', async () => {
                    state.currentTrack = (state.currentTrack + 1) % playlist.length;
                    currentTime = 0;
                    const audio = document.getElementById('audioEl');
                    const trackTitle = document.getElementById('trackTitle');
                    if (trackTitle) trackTitle.textContent = playlist[state.currentTrack].title;
                    if (audio) {
                        audio._fallbackTried = false;
                        audio.src = playlist[state.currentTrack].file || '';
                        audio.currentTime = 0;
                        audio.volume = state.volume ?? 0.7;
                        if (state.isPlaying) {
                            try { await audio.play(); } catch (err) { console.warn('Play on next failed:', err); state.isPlaying = false; const p = document.getElementById('playBtn'); if (p) p.textContent = '‚ñ∂'; }
                        }
                    }
                });
            }

            const progressContainer = document.getElementById('progressContainer');
            if (progressContainer) {
                progressContainer.addEventListener('click', (e) => {
                    const audio = document.getElementById('audioEl');
                    const rect = progressContainer.getBoundingClientRect();
                    const percent = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
                    if (audio && audio.duration) {
                        audio.currentTime = percent * audio.duration;
                        // update UI immediately
                        const progressBar = document.getElementById('progressBar');
                        const currentTimeEl = document.getElementById('currentTime');
                        if (progressBar) progressBar.style.width = (percent * 100) + '%';
                        if (currentTimeEl) currentTimeEl.textContent = formatTime(Math.floor(percent * audio.duration));
                    } else {
                        // fallback to estimated duration (no full re-render)
                        currentTime = Math.floor(percent * (playlist[state.currentTrack].duration || 0));
                        const progressBar = document.getElementById('progressBar');
                        const currentTimeEl = document.getElementById('currentTime');
                        if (progressBar) progressBar.style.width = (percent * 100) + '%';
                        if (currentTimeEl) currentTimeEl.textContent = formatTime(currentTime);
                    }
                });
            }

            const volumeSlider = document.getElementById('volumeSlider');
            if (volumeSlider) {
                volumeSlider.addEventListener('click', (e) => {
                    const rect = volumeSlider.getBoundingClientRect();
                    const percent = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
                    state.volume = percent;
                    const audio = document.getElementById('audioEl');
                    const volumeBar = document.getElementById('volumeBar');
                    if (audio) audio.volume = state.volume;
                    if (volumeBar) volumeBar.style.width = (state.volume * 100) + '%';
                });
            }

            // Chatroom removed
        }

        // Helper functions
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function formatTimestamp(timestamp) {
            const date = new Date(timestamp);
            return date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        }

        // Initial render
        render();
    </script>
</body>
</html>